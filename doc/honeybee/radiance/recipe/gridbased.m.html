<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>honeybee.radiance.recipe.gridbased API documentation</title>
    <meta name="description" content="Radiance Analysis Recipes." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>

  <!-- highlight.js for highlighting source code. -->
  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.2.0/styles/default.min.css">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.2.0/highlight.min.js"></script>

  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 0.9em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    margin-left: 25%;
    max-width: 90%;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    position: fixed;
    height: 100%;
    width: 25%;
    float: left;
    padding: 30px;
    overflow-x: hidden;
    overflow-y: auto;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; }

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;

      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: auto;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }

  .desc {
    white-space: pre-wrap;
  }

  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
        position: inherit;
        float: none;
        width: auto;
    }
    #content {
      width: 95%;
      margin-left: auto;
      border-left: none;
      padding: 30px;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>


  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe">HBGridBasedAnalysisRecipe</a></span>
        
          
  <ul>
    <li class="mono"><a href="#honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.write">write</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.__init__">__init__</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.createAnalysisPointGroups">createAnalysisPointGroups</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.flatten">flatten</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.hbObjectsToRadString">hbObjectsToRadString</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.results">results</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.run">run</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.toRadString">toRadString</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.updatePointGroups">updatePointGroups</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.writeHBObjectsToFile">writeHBObjectsToFile</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.writePointsToFile">writePointsToFile</a></li>
    <li class="mono"><a href="#honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.writeToFile">writeToFile</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">honeybee.radiance.recipe.gridbased</span> module</h1>
  <p>Radiance Analysis Recipes.</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.gridbased', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.gridbased" class="source">
    <pre><code>"""Radiance Analysis Recipes."""

from ..postprocess.gridbasedresults import LoadGridBasedDLAnalysisResults
from ...hbpointgroup import AnalysisPointGroup
from .recipeBase import HBDaylightAnalysisRecipe
from ..command.oconv import Oconv
from ..command.rtrace import Rtrace
from ...helper import preparedir

import os
from collections import namedtuple, Iterable
import subprocess


class HBGridBasedAnalysisRecipe(HBDaylightAnalysisRecipe):
    """Grid base analysis base class.

    Attributes:
        sky: A honeybee sky for the analysis
        pointGroups: A list of (x, y, z) test points or lists of (x, y, z) test points.
            Each list of test points will be converted to a TestPointGroup. If testPts
            is a single flattened list only one TestPointGroup will be created.
        vectorGroups: An optional list of (x, y, z) vectors. Each vector represents direction
            of corresponding point in testPts. If the vector is not provided (0, 0, 1)
            will be assigned.
        simulationType: 0: Illuminance(lux), 1: Radiation (kWh), 2: Luminance (Candela)
            (Default: 0)
        radParameters: Radiance parameters for this analysis.
            (Default: RadianceParameters.LowQuality)
        hbObjects: An optional list of Honeybee surfaces or zones (Default: None).
        subFolder: Analysis subfolder for this recipe. (Default: "gridbased")
    """

    # TODO: implemnt isChanged at HBDaylightAnalysisRecipe level to reload the results
    # if there has been no changes in inputs.
    def __init__(self, sky, pointGroups, vectorGroups=[], simulationType=0,
                 radParameters=None, hbObjects=None, subFolder="gridbased"):
        """Create grid-based recipe."""
        HBDaylightAnalysisRecipe.__init__(self, sky=sky,
                                          simulationType=simulationType,
                                          radParameters=radParameters,
                                          hbObjects=hbObjects,
                                          subFolder=subFolder)

        self.__batchFile = None
        self.resultsFile = []

        # create a result loader to load the results once the analysis is done.
        self.loader = LoadGridBasedDLAnalysisResults(self.simulationType,
                                                     self.resultsFile)

        # create analysisi point groups
        self.createAnalysisPointGroups(pointGroups, vectorGroups)

    @property
    def pointGroups(self):
        """Return analysis point groups."""
        return self.analysisPointsGroups

    @pointGroups.setter
    def pointGroups(self):
        """Return analysis point groups."""
        raise ValueError("You can't set pointGroups directly. " +
                         "Use updatePointGroups method instead.")

    def updatePointGroups(self, pointGroups, vectorGroups=[]):
        """Update point groups.

        Args:
            pointGroups: A list of (x, y, z) test points or lists of (x, y, z)
                test points. Each list of test points will be converted to a
                TestPointGroup. If testPts is a single flattened list only one
                TestPointGroup will be created.
            vectorGroups: An optional list of (x, y, z) vectors. Each vector
                represents direction of corresponding point in testPts. If the
                vector is not provided (0, 0, 1) will be assigned.
        """
        self.createAnalysisPointGroups(pointGroups, vectorGroups)

    @property
    def points(self):
        """Return nested list of points."""
        return [ap.points for ap in self.analysisPointsGroups]

    @property
    def numOfPointGroups(self):
        """Number of point groups."""
        return len(self.analysisPointsGroups)

    @property
    def numOfTotalPoints(self):
        """Number of total points."""
        return sum(len(ap) for ap in self.analysisPointsGroups)

    @property
    def vectors(self):
        """Nested list of vectors."""
        return [ap.vectors for ap in self.analysisPointsGroups]

    @property
    def analysisPointsGroups(self):
        """Return list of AnalysisPointGroups."""
        return self.__analysisPointGroups

    def createAnalysisPointGroups(self, pointGroups, vectorGroups):
        """Create AnalysisPointGroups from input points and vectors.

        You can acces AnalysisPointGroups using self.analysisPointsGroups property.
        """
        self.__analysisPointGroups = []

        if len(pointGroups) == 0:
            return
        # input is single point! Create a single group but seriously!?
        elif not isinstance(pointGroups[0], Iterable):
            pointGroups = [[pointGroups]]
            vectorGroups = [[vectorGroups]]
        # if point group is flatten - create a single group
        elif not isinstance(pointGroups[0][0], Iterable) and not hasattr(pointGroups[0][0], "X"):
            pointGroups = [pointGroups]
            vectorGroups = [vectorGroups]

        for groupCount, pts in enumerate(pointGroups):
            try:
                # create a list for vectors if it's not provided by user
                vectors = vectorGroups[groupCount]
                if vectors == [[]]:
                    vectors = [(0, 0, 1)]
            except IndexError:
                vectors = [(0, 0, 1)]
            finally:
                # last check for vectors in case user input is a flatten lists
                # for nested group of points.
                if not isinstance(vectors[0], Iterable) and not hasattr(vectors[0], 'X'):
                    vectors = [vectors]

                self.__analysisPointGroups.append(AnalysisPointGroup(pts, vectors))

    def flatten(self, inputList):
        """Return a flattened genertor from an input list.

        Usage:

            inputList = [['a'], ['b', 'c', 'd'], [['e']], ['f']]
            list(flatten(inputList))
            >> ['a', 'b', 'c', 'd', 'e', 'f']
        """
        for el in inputList:
            if isinstance(el, Iterable) and not isinstance(el, basestring):
                for sub in self.flatten(el):
                    yield sub
            else:
                yield el

    def toRadString(self, hbObjects=False, points=False):
        """Return a tuple of multiline string radiance definition.

        Args:
            hbObjects: Set to True to generate string for materials and geometries (Default: False).
            points: Set to True to generate string for points (Default: False).

        Returns:
            A namedTuple of multiline data. Keys are: points materials geometries

        Usage:
            s = self.toRadString(True, True)
            ptsString , matString, geoString = s
            or
            s = self.toRadString(points=True)
            ptsString = s.points
        """
        _radDefinition = namedtuple("RadString", "points materials geometries")
        _ptsStr = ""
        _matStr = ""
        _geoStr = ""

        if points:
            _ptsStr = "\n".join([ap.toRadString() for ap in self.analysisPointsGroups])

        if hbObjects:
            _matStr, _geoStr = self.hbObjectsToRadString()

        return _radDefinition(_ptsStr, _matStr, _geoStr)

    def writePointsToFile(self, targetDir, projectName, mkdir=False):
        """Write point groups to file.

        Args:
            targetDir: Path to project directory (e.g. c:/ladybug)
            projectName: Project name as string.Points will be saved as
                projectName.pts

        Returns:
            Path to file in case of success.

        Exceptions:
            ValueError if targetDir doesn't exist and mkdir is False.
        """
        assert type(projectName) is str, "projectName should be a string."
        projectName += ".pts"

        _pts = self.write(os.path.join(targetDir, projectName),
                          self.toRadString(points=True).points, mkdir)

        if _pts:
            return _pts

    def writeHBObjectsToFile(self, targetDir, projectName, mkdir=False,
                             writeMaterial=True, writeGeometry=True):
        """Write HBobjects to *.rad and .mat files.

        Args:
            targetDir: Path to project directory (e.g. c:/ladybug)
            projectName: Project name as string. Geometries will be saved as
                projectName.rad and materials will be saved as projectName.mat
            mkdir: Set to True to create the directory if doesn't exist (Default: False)

        Returns:
            Path to materiald and geometry files as a tuple (*.mat, *.rad).

        Exceptions:
            ValueError if targetDir doesn't exist and mkdir is False.
        """
        assert type(projectName) is str, "projectName should be a string."

        _matStr, _geoStr = self.hbObjectsToRadString()

        _mat = self.write(os.path.join(targetDir, projectName + ".mat"),
                          _matStr, mkdir) if writeMaterial else " "

        _geo = self.write(os.path.join(targetDir, projectName + ".rad"),
                          _geoStr, mkdir) if writeMaterial else " "

        if _mat and _geo:
            return _mat, _geo

    # TODO: Add path to PATH and use relative path in batch files
    def writeToFile(self, targetFolder, projectName, radFiles=None,
                    useRelativePath=False):
        """Write analysis files to target folder.

        Files for a grid based analysis are:
            test points <projectName.pts>: List of analysis points.
            sky file <*.sky>: Radiance sky for this analysis.
            material file <*.mat>: Radiance materials. Will be empty if HBObjects is None.
            geometry file <*.rad>: Radiance geometries. Will be empty if HBObjects is None.
            sky file <*.sky>: Radiance sky for this analysis.
            batch file <*.bat>: An executable batch file which has the list of commands.
                oconve <*.sky> <projectName.mat> <projectName.rad> <additional radFiles> > <projectName.oct>
                rtrace <radianceParameters> <projectName.oct> > <projectName.res>
            results file <*.res>: Results file once the analysis is over.

        Args:
            targetFolder: Path to parent folder. Files will be created under
                targetFolder/gridbased. use self.subFolder to change subfolder name.
            projectName: Name of this project as a string.
            radFiles: A list of additional .rad files to be added to the scene
            useRelativePath: Set to True to use relative path in bat file <NotImplemented!>.

        Returns:
            True in case of success.
        """
        # 0.prepare target folder
        # create main folder targetFolder\projectName
        _basePath = os.path.join(targetFolder, projectName)
        _ispath = preparedir(_basePath)
        assert _ispath, "Failed to create %s. Try a different path!" % _basePath

        # create main folder targetFolder\projectName\gridbased
        _path = os.path.join(_basePath, self.subFolder)
        _ispath = preparedir(_path)

        assert _ispath, "Failed to create %s. Try a different path!" % _path

        # Check if anything has changed
        # if not self.isChanged:
        #     print "Inputs has not changed! Check files at %s" % _path

        # 1.write sky file
        skyFile = self.sky.writeToFile(_path)

        # 2.write points
        pointsFile = self.writePointsToFile(_path, projectName)

        # 3.write materials and geometry files
        matFile, geoFile = self.writeHBObjectsToFile(_path, projectName)

        # 4.write batch file
        batchFileLines = []

        # TODO: This line won't work for in linux.
        dirLine = "%s\ncd %s" % (os.path.splitdrive(_path)[0], _path)
        batchFileLines.append(dirLine)

        # # 4.1.prepare oconv
        oc = Oconv(projectName)
        oc.inputFiles = [skyFile, matFile, geoFile]

        # # 4.2.prepare rtrace
        rt = Rtrace(projectName,
                    simulationType=self.simulationType,
                    radianceParameters=self.radianceParameters)
        rt.octFile = os.path.join(_path, projectName + ".oct")
        rt.pointFile = pointsFile

        # # 4.3 write batch file
        batchFileLines.append(oc.toRadString())
        batchFileLines.append(rt.toRadString())
        batchFile = os.path.join(_path, projectName + ".bat")

        self.write(batchFile, "\n".join(batchFileLines))

        self.__batchFile = batchFile

        print "Files are written to: %s" % _path
        return _path

    # TODO: Update the method to batch run and move it to baseclass
    def run(self, debug=False):
        """Run the analysis."""
        if self.__batchFile:
            if debug:
                with open(self.__batchFile, "a") as bf:
                    bf.write("\npause")

            subprocess.call(self.__batchFile)

            self.isCalculated = True
            # self.isChanged = False

            self.resultsFile = [self.__batchFile.replace(".bat", ".res")]
            return True
        else:
            raise Exception("You need to write the files before running the recipe.")

    def results(self, flattenResults=True):
        """Return results for this analysis."""
        assert self.isCalculated, \
            "You haven't run the Recipe yet. Use self.run " + \
            "to run the analysis before loading the results."

        self.loader.simulationType = self.simulationType
        self.loader.resultFiles = self.resultsFile
        return self.loader.results

    def __repr__(self):
        """Represent grid based recipe."""
        _analysisType = {
            0: "Illuminance", 1: "Radiation", 2: "Luminance"
        }
        return "%s: %s\n#PointGroups: %d #Points: %d" % \
            (self.__class__.__name__,
             _analysisType[self.simulationType],
             self.numOfPointGroups,
             self.numOfTotalPoints)


if __name__ == "__main__":
    # test code
    from sky.certainIlluminance import SkyWithCertainIlluminanceLevel

    sky = SkyWithCertainIlluminanceLevel(2000)
    rp = HBGridBasedAnalysisRecipe(sky, [[(0, 0, 0), (10, 0, 0)]])

    print rp
    print "vectors:", rp.ptsVectors

    rp.writePointsToFile("c:/ladybug/points.pts")
</code></pre>
  </div>

  </header>

  <section id="section-items">


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe" class="name">class <span class="ident">HBGridBasedAnalysisRecipe</span></p>
      
  
    <div class="desc"><p>Grid base analysis base class.</p>
<p>Attributes:
    sky: A honeybee sky for the analysis
    pointGroups: A list of (x, y, z) test points or lists of (x, y, z) test points.
        Each list of test points will be converted to a TestPointGroup. If testPts
        is a single flattened list only one TestPointGroup will be created.
    vectorGroups: An optional list of (x, y, z) vectors. Each vector represents direction
        of corresponding point in testPts. If the vector is not provided (0, 0, 1)
        will be assigned.
    simulationType: 0: Illuminance(lux), 1: Radiation (kWh), 2: Luminance (Candela)
        (Default: 0)
    radParameters: Radiance parameters for this analysis.
        (Default: RadianceParameters.LowQuality)
    hbObjects: An optional list of Honeybee surfaces or zones (Default: None).
    subFolder: Analysis subfolder for this recipe. (Default: "gridbased")</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe" class="source">
    <pre><code>class HBGridBasedAnalysisRecipe(HBDaylightAnalysisRecipe):
    """Grid base analysis base class.

    Attributes:
        sky: A honeybee sky for the analysis
        pointGroups: A list of (x, y, z) test points or lists of (x, y, z) test points.
            Each list of test points will be converted to a TestPointGroup. If testPts
            is a single flattened list only one TestPointGroup will be created.
        vectorGroups: An optional list of (x, y, z) vectors. Each vector represents direction
            of corresponding point in testPts. If the vector is not provided (0, 0, 1)
            will be assigned.
        simulationType: 0: Illuminance(lux), 1: Radiation (kWh), 2: Luminance (Candela)
            (Default: 0)
        radParameters: Radiance parameters for this analysis.
            (Default: RadianceParameters.LowQuality)
        hbObjects: An optional list of Honeybee surfaces or zones (Default: None).
        subFolder: Analysis subfolder for this recipe. (Default: "gridbased")
    """

    # TODO: implemnt isChanged at HBDaylightAnalysisRecipe level to reload the results
    # if there has been no changes in inputs.
    def __init__(self, sky, pointGroups, vectorGroups=[], simulationType=0,
                 radParameters=None, hbObjects=None, subFolder="gridbased"):
        """Create grid-based recipe."""
        HBDaylightAnalysisRecipe.__init__(self, sky=sky,
                                          simulationType=simulationType,
                                          radParameters=radParameters,
                                          hbObjects=hbObjects,
                                          subFolder=subFolder)

        self.__batchFile = None
        self.resultsFile = []

        # create a result loader to load the results once the analysis is done.
        self.loader = LoadGridBasedDLAnalysisResults(self.simulationType,
                                                     self.resultsFile)

        # create analysisi point groups
        self.createAnalysisPointGroups(pointGroups, vectorGroups)

    @property
    def pointGroups(self):
        """Return analysis point groups."""
        return self.analysisPointsGroups

    @pointGroups.setter
    def pointGroups(self):
        """Return analysis point groups."""
        raise ValueError("You can't set pointGroups directly. " +
                         "Use updatePointGroups method instead.")

    def updatePointGroups(self, pointGroups, vectorGroups=[]):
        """Update point groups.

        Args:
            pointGroups: A list of (x, y, z) test points or lists of (x, y, z)
                test points. Each list of test points will be converted to a
                TestPointGroup. If testPts is a single flattened list only one
                TestPointGroup will be created.
            vectorGroups: An optional list of (x, y, z) vectors. Each vector
                represents direction of corresponding point in testPts. If the
                vector is not provided (0, 0, 1) will be assigned.
        """
        self.createAnalysisPointGroups(pointGroups, vectorGroups)

    @property
    def points(self):
        """Return nested list of points."""
        return [ap.points for ap in self.analysisPointsGroups]

    @property
    def numOfPointGroups(self):
        """Number of point groups."""
        return len(self.analysisPointsGroups)

    @property
    def numOfTotalPoints(self):
        """Number of total points."""
        return sum(len(ap) for ap in self.analysisPointsGroups)

    @property
    def vectors(self):
        """Nested list of vectors."""
        return [ap.vectors for ap in self.analysisPointsGroups]

    @property
    def analysisPointsGroups(self):
        """Return list of AnalysisPointGroups."""
        return self.__analysisPointGroups

    def createAnalysisPointGroups(self, pointGroups, vectorGroups):
        """Create AnalysisPointGroups from input points and vectors.

        You can acces AnalysisPointGroups using self.analysisPointsGroups property.
        """
        self.__analysisPointGroups = []

        if len(pointGroups) == 0:
            return
        # input is single point! Create a single group but seriously!?
        elif not isinstance(pointGroups[0], Iterable):
            pointGroups = [[pointGroups]]
            vectorGroups = [[vectorGroups]]
        # if point group is flatten - create a single group
        elif not isinstance(pointGroups[0][0], Iterable) and not hasattr(pointGroups[0][0], "X"):
            pointGroups = [pointGroups]
            vectorGroups = [vectorGroups]

        for groupCount, pts in enumerate(pointGroups):
            try:
                # create a list for vectors if it's not provided by user
                vectors = vectorGroups[groupCount]
                if vectors == [[]]:
                    vectors = [(0, 0, 1)]
            except IndexError:
                vectors = [(0, 0, 1)]
            finally:
                # last check for vectors in case user input is a flatten lists
                # for nested group of points.
                if not isinstance(vectors[0], Iterable) and not hasattr(vectors[0], 'X'):
                    vectors = [vectors]

                self.__analysisPointGroups.append(AnalysisPointGroup(pts, vectors))

    def flatten(self, inputList):
        """Return a flattened genertor from an input list.

        Usage:

            inputList = [['a'], ['b', 'c', 'd'], [['e']], ['f']]
            list(flatten(inputList))
            >> ['a', 'b', 'c', 'd', 'e', 'f']
        """
        for el in inputList:
            if isinstance(el, Iterable) and not isinstance(el, basestring):
                for sub in self.flatten(el):
                    yield sub
            else:
                yield el

    def toRadString(self, hbObjects=False, points=False):
        """Return a tuple of multiline string radiance definition.

        Args:
            hbObjects: Set to True to generate string for materials and geometries (Default: False).
            points: Set to True to generate string for points (Default: False).

        Returns:
            A namedTuple of multiline data. Keys are: points materials geometries

        Usage:
            s = self.toRadString(True, True)
            ptsString , matString, geoString = s
            or
            s = self.toRadString(points=True)
            ptsString = s.points
        """
        _radDefinition = namedtuple("RadString", "points materials geometries")
        _ptsStr = ""
        _matStr = ""
        _geoStr = ""

        if points:
            _ptsStr = "\n".join([ap.toRadString() for ap in self.analysisPointsGroups])

        if hbObjects:
            _matStr, _geoStr = self.hbObjectsToRadString()

        return _radDefinition(_ptsStr, _matStr, _geoStr)

    def writePointsToFile(self, targetDir, projectName, mkdir=False):
        """Write point groups to file.

        Args:
            targetDir: Path to project directory (e.g. c:/ladybug)
            projectName: Project name as string.Points will be saved as
                projectName.pts

        Returns:
            Path to file in case of success.

        Exceptions:
            ValueError if targetDir doesn't exist and mkdir is False.
        """
        assert type(projectName) is str, "projectName should be a string."
        projectName += ".pts"

        _pts = self.write(os.path.join(targetDir, projectName),
                          self.toRadString(points=True).points, mkdir)

        if _pts:
            return _pts

    def writeHBObjectsToFile(self, targetDir, projectName, mkdir=False,
                             writeMaterial=True, writeGeometry=True):
        """Write HBobjects to *.rad and .mat files.

        Args:
            targetDir: Path to project directory (e.g. c:/ladybug)
            projectName: Project name as string. Geometries will be saved as
                projectName.rad and materials will be saved as projectName.mat
            mkdir: Set to True to create the directory if doesn't exist (Default: False)

        Returns:
            Path to materiald and geometry files as a tuple (*.mat, *.rad).

        Exceptions:
            ValueError if targetDir doesn't exist and mkdir is False.
        """
        assert type(projectName) is str, "projectName should be a string."

        _matStr, _geoStr = self.hbObjectsToRadString()

        _mat = self.write(os.path.join(targetDir, projectName + ".mat"),
                          _matStr, mkdir) if writeMaterial else " "

        _geo = self.write(os.path.join(targetDir, projectName + ".rad"),
                          _geoStr, mkdir) if writeMaterial else " "

        if _mat and _geo:
            return _mat, _geo

    # TODO: Add path to PATH and use relative path in batch files
    def writeToFile(self, targetFolder, projectName, radFiles=None,
                    useRelativePath=False):
        """Write analysis files to target folder.

        Files for a grid based analysis are:
            test points <projectName.pts>: List of analysis points.
            sky file <*.sky>: Radiance sky for this analysis.
            material file <*.mat>: Radiance materials. Will be empty if HBObjects is None.
            geometry file <*.rad>: Radiance geometries. Will be empty if HBObjects is None.
            sky file <*.sky>: Radiance sky for this analysis.
            batch file <*.bat>: An executable batch file which has the list of commands.
                oconve <*.sky> <projectName.mat> <projectName.rad> <additional radFiles> > <projectName.oct>
                rtrace <radianceParameters> <projectName.oct> > <projectName.res>
            results file <*.res>: Results file once the analysis is over.

        Args:
            targetFolder: Path to parent folder. Files will be created under
                targetFolder/gridbased. use self.subFolder to change subfolder name.
            projectName: Name of this project as a string.
            radFiles: A list of additional .rad files to be added to the scene
            useRelativePath: Set to True to use relative path in bat file <NotImplemented!>.

        Returns:
            True in case of success.
        """
        # 0.prepare target folder
        # create main folder targetFolder\projectName
        _basePath = os.path.join(targetFolder, projectName)
        _ispath = preparedir(_basePath)
        assert _ispath, "Failed to create %s. Try a different path!" % _basePath

        # create main folder targetFolder\projectName\gridbased
        _path = os.path.join(_basePath, self.subFolder)
        _ispath = preparedir(_path)

        assert _ispath, "Failed to create %s. Try a different path!" % _path

        # Check if anything has changed
        # if not self.isChanged:
        #     print "Inputs has not changed! Check files at %s" % _path

        # 1.write sky file
        skyFile = self.sky.writeToFile(_path)

        # 2.write points
        pointsFile = self.writePointsToFile(_path, projectName)

        # 3.write materials and geometry files
        matFile, geoFile = self.writeHBObjectsToFile(_path, projectName)

        # 4.write batch file
        batchFileLines = []

        # TODO: This line won't work for in linux.
        dirLine = "%s\ncd %s" % (os.path.splitdrive(_path)[0], _path)
        batchFileLines.append(dirLine)

        # # 4.1.prepare oconv
        oc = Oconv(projectName)
        oc.inputFiles = [skyFile, matFile, geoFile]

        # # 4.2.prepare rtrace
        rt = Rtrace(projectName,
                    simulationType=self.simulationType,
                    radianceParameters=self.radianceParameters)
        rt.octFile = os.path.join(_path, projectName + ".oct")
        rt.pointFile = pointsFile

        # # 4.3 write batch file
        batchFileLines.append(oc.toRadString())
        batchFileLines.append(rt.toRadString())
        batchFile = os.path.join(_path, projectName + ".bat")

        self.write(batchFile, "\n".join(batchFileLines))

        self.__batchFile = batchFile

        print "Files are written to: %s" % _path
        return _path

    # TODO: Update the method to batch run and move it to baseclass
    def run(self, debug=False):
        """Run the analysis."""
        if self.__batchFile:
            if debug:
                with open(self.__batchFile, "a") as bf:
                    bf.write("\npause")

            subprocess.call(self.__batchFile)

            self.isCalculated = True
            # self.isChanged = False

            self.resultsFile = [self.__batchFile.replace(".bat", ".res")]
            return True
        else:
            raise Exception("You need to write the files before running the recipe.")

    def results(self, flattenResults=True):
        """Return results for this analysis."""
        assert self.isCalculated, \
            "You haven't run the Recipe yet. Use self.run " + \
            "to run the analysis before loading the results."

        self.loader.simulationType = self.simulationType
        self.loader.resultFiles = self.resultsFile
        return self.loader.results

    def __repr__(self):
        """Represent grid based recipe."""
        _analysisType = {
            0: "Illuminance", 1: "Radiation", 2: "Luminance"
        }
        return "%s: %s\n#PointGroups: %d #Points: %d" % \
            (self.__class__.__name__,
             _analysisType[self.simulationType],
             self.numOfPointGroups,
             self.numOfTotalPoints)
</code></pre>
  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe">HBGridBasedAnalysisRecipe</a></li>
          <li>honeybee.radiance.recipe.recipeBase.HBDaylightAnalysisRecipe</li>
          <li>__builtin__.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.write">
    <p>def <span class="ident">write</span>(</p><p>filePath, data, mkdir=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Write a string of data to file.</p>
<p>Args:
    filePath: Full path for a valid file path (e.g. c:/ladybug/testPts.pts)
    data: Any data as string
    mkdir: Set to True to create the directory if doesn't exist (Default: False)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.write', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.write" class="source">
    <pre><code>@staticmethod
def write(filePath, data, mkdir=False):
    """Write a string of data to file.
    Args:
        filePath: Full path for a valid file path (e.g. c:/ladybug/testPts.pts)
        data: Any data as string
        mkdir: Set to True to create the directory if doesn't exist (Default: False)
    """
    __dir, __name = os.path.split(filePath)
    if not os.path.isdir(__dir):
        if mkdir:
            preparedir(__dir)
        else:
            raise ValueError("Target dir doesn't exist: %s" % __dir)
    with open(filePath, "w") as outf:
        try:
            outf.write(str(data))
            return filePath
        except Exception as e:
            print "Failed to write points to file:\n%s" % e
            return False
</code></pre>
  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.analysisPointsGroups" class="name">var <span class="ident">analysisPointsGroups</span></p>
            

            
  
    <div class="desc"><p>Return list of AnalysisPointGroups.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.hbObjects" class="name">var <span class="ident">hbObjects</span></p>
            

            
  
    <div class="desc"><p>Get and set Honeybee objects for this recipe.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.isAnalysisRecipe" class="name">var <span class="ident">isAnalysisRecipe</span></p>
            

            
  
    <div class="desc"><p>Return true to indicate it is an analysis recipe.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.loader" class="name">var <span class="ident">loader</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.numOfPointGroups" class="name">var <span class="ident">numOfPointGroups</span></p>
            

            
  
    <div class="desc"><p>Number of point groups.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.numOfTotalPoints" class="name">var <span class="ident">numOfTotalPoints</span></p>
            

            
  
    <div class="desc"><p>Number of total points.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.pointGroups" class="name">var <span class="ident">pointGroups</span></p>
            

            
  
    <div class="desc"><p>Return analysis point groups.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.points" class="name">var <span class="ident">points</span></p>
            

            
  
    <div class="desc"><p>Return nested list of points.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.radianceParameters" class="name">var <span class="ident">radianceParameters</span></p>
            

            
  
    <div class="desc"><p>Get and set Radiance parameters.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.resultsFile" class="name">var <span class="ident">resultsFile</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.simulationType" class="name">var <span class="ident">simulationType</span></p>
            

            
  
    <div class="desc"><p>Get/set simulation Type.</p>
<p>0: Illuminance(lux), 1: Radiation (kWh), 2: Luminance (Candela) (Default: 0)</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.sky" class="name">var <span class="ident">sky</span></p>
            

            
  
    <div class="desc"><p>Get and set sky definition.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.subFolder" class="name">var <span class="ident">subFolder</span></p>
            

            
  
    <div class="desc"><p>Sub-folder for Grid-based analysis.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.vectors" class="name">var <span class="ident">vectors</span></p>
            

            
  
    <div class="desc"><p>Nested list of vectors.</p></div>
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, sky, pointGroups, vectorGroups=[], simulationType=0, radParameters=None, hbObjects=None, subFolder=&#39;gridbased&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Create grid-based recipe.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.__init__', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.__init__" class="source">
    <pre><code>def __init__(self, sky, pointGroups, vectorGroups=[], simulationType=0,
             radParameters=None, hbObjects=None, subFolder="gridbased"):
    """Create grid-based recipe."""
    HBDaylightAnalysisRecipe.__init__(self, sky=sky,
                                      simulationType=simulationType,
                                      radParameters=radParameters,
                                      hbObjects=hbObjects,
                                      subFolder=subFolder)
    self.__batchFile = None
    self.resultsFile = []
    # create a result loader to load the results once the analysis is done.
    self.loader = LoadGridBasedDLAnalysisResults(self.simulationType,
                                                 self.resultsFile)
    # create analysisi point groups
    self.createAnalysisPointGroups(pointGroups, vectorGroups)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.createAnalysisPointGroups">
    <p>def <span class="ident">createAnalysisPointGroups</span>(</p><p>self, pointGroups, vectorGroups)</p>
    </div>
    

    
  
    <div class="desc"><p>Create AnalysisPointGroups from input points and vectors.</p>
<p>You can acces AnalysisPointGroups using self.analysisPointsGroups property.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.createAnalysisPointGroups', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.createAnalysisPointGroups" class="source">
    <pre><code>def createAnalysisPointGroups(self, pointGroups, vectorGroups):
    """Create AnalysisPointGroups from input points and vectors.
    You can acces AnalysisPointGroups using self.analysisPointsGroups property.
    """
    self.__analysisPointGroups = []
    if len(pointGroups) == 0:
        return
    # input is single point! Create a single group but seriously!?
    elif not isinstance(pointGroups[0], Iterable):
        pointGroups = [[pointGroups]]
        vectorGroups = [[vectorGroups]]
    # if point group is flatten - create a single group
    elif not isinstance(pointGroups[0][0], Iterable) and not hasattr(pointGroups[0][0], "X"):
        pointGroups = [pointGroups]
        vectorGroups = [vectorGroups]
    for groupCount, pts in enumerate(pointGroups):
        try:
            # create a list for vectors if it's not provided by user
            vectors = vectorGroups[groupCount]
            if vectors == [[]]:
                vectors = [(0, 0, 1)]
        except IndexError:
            vectors = [(0, 0, 1)]
        finally:
            # last check for vectors in case user input is a flatten lists
            # for nested group of points.
            if not isinstance(vectors[0], Iterable) and not hasattr(vectors[0], 'X'):
                vectors = [vectors]
            self.__analysisPointGroups.append(AnalysisPointGroup(pts, vectors))
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.flatten">
    <p>def <span class="ident">flatten</span>(</p><p>self, inputList)</p>
    </div>
    

    
  
    <div class="desc"><p>Return a flattened genertor from an input list.</p>
<p>Usage:</p>
<pre><code>inputList = [['a'], ['b', 'c', 'd'], [['e']], ['f']]
list(flatten(inputList))
&gt;&gt; ['a', 'b', 'c', 'd', 'e', 'f']
</code></pre></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.flatten', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.flatten" class="source">
    <pre><code>def flatten(self, inputList):
    """Return a flattened genertor from an input list.
    Usage:
        inputList = [['a'], ['b', 'c', 'd'], [['e']], ['f']]
        list(flatten(inputList))
        >> ['a', 'b', 'c', 'd', 'e', 'f']
    """
    for el in inputList:
        if isinstance(el, Iterable) and not isinstance(el, basestring):
            for sub in self.flatten(el):
                yield sub
        else:
            yield el
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.hbObjectsToRadString">
    <p>def <span class="ident">hbObjectsToRadString</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Return geometries and materials as a tuple of multiline string.</p>
<p>Returns:
    A namedTuple of multiline data. Keys are: materials geometries</p>
<p>Usage:
    s = self.hbObjectsToRadString()
    geoString = s.geometries
    matString = s.materials
    or
    s = self.hbObjectsToRadString()
    matString, geoString = s</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.hbObjectsToRadString', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.hbObjectsToRadString" class="source">
    <pre><code>def hbObjectsToRadString(self):
    """Return geometries and materials as a tuple of multiline string.
    Returns:
        A namedTuple of multiline data. Keys are: materials geometries
    Usage:
        s = self.hbObjectsToRadString()
        geoString = s.geometries
        matString = s.materials
        or
        s = self.hbObjectsToRadString()
        matString, geoString = s
    """
    _radDefinition = namedtuple("RadString", "materials geometries")
    _matStr = ""
    _geoStr = ""
    if len(self.hbObjects) > 0:
        _materials = []
        _geos = []
        for hbo in self.hbObjects:
            try:
                # hbzone or HBSurface with child surface returns a list of materials
                _materials.extend(hbo.radianceMaterial)
            except:
                # hb surface with no child surface
                _materials.append(hbo.radianceMaterial)
            _geos.append(hbo.toRadString())
        # remove duplicated materials
        _materials = set([mat.toRadString() for mat in _materials])
        _matStr = "\n".join(_materials)
        # joing geometries
        _geoStr = "\n".join(_geos)
        print "Number of total materials: %d" % len(_materials)
        print "Number of total surfaces: %d" % len(_geos)
    else:
        print "Warning: Found no Honeybee objects."
    return _radDefinition(_matStr, _geoStr)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.results">
    <p>def <span class="ident">results</span>(</p><p>self, flattenResults=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Return results for this analysis.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.results', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.results" class="source">
    <pre><code>def results(self, flattenResults=True):
    """Return results for this analysis."""
    assert self.isCalculated, \
        "You haven't run the Recipe yet. Use self.run " + \
        "to run the analysis before loading the results."
    self.loader.simulationType = self.simulationType
    self.loader.resultFiles = self.resultsFile
    return self.loader.results
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.run">
    <p>def <span class="ident">run</span>(</p><p>self, debug=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Run the analysis.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.run', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.run" class="source">
    <pre><code>def run(self, debug=False):
    """Run the analysis."""
    if self.__batchFile:
        if debug:
            with open(self.__batchFile, "a") as bf:
                bf.write("\npause")
        subprocess.call(self.__batchFile)
        self.isCalculated = True
        # self.isChanged = False
        self.resultsFile = [self.__batchFile.replace(".bat", ".res")]
        return True
    else:
        raise Exception("You need to write the files before running the recipe.")
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.toRadString">
    <p>def <span class="ident">toRadString</span>(</p><p>self, hbObjects=False, points=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Return a tuple of multiline string radiance definition.</p>
<p>Args:
    hbObjects: Set to True to generate string for materials and geometries (Default: False).
    points: Set to True to generate string for points (Default: False).</p>
<p>Returns:
    A namedTuple of multiline data. Keys are: points materials geometries</p>
<p>Usage:
    s = self.toRadString(True, True)
    ptsString , matString, geoString = s
    or
    s = self.toRadString(points=True)
    ptsString = s.points</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.toRadString', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.toRadString" class="source">
    <pre><code>def toRadString(self, hbObjects=False, points=False):
    """Return a tuple of multiline string radiance definition.
    Args:
        hbObjects: Set to True to generate string for materials and geometries (Default: False).
        points: Set to True to generate string for points (Default: False).
    Returns:
        A namedTuple of multiline data. Keys are: points materials geometries
    Usage:
        s = self.toRadString(True, True)
        ptsString , matString, geoString = s
        or
        s = self.toRadString(points=True)
        ptsString = s.points
    """
    _radDefinition = namedtuple("RadString", "points materials geometries")
    _ptsStr = ""
    _matStr = ""
    _geoStr = ""
    if points:
        _ptsStr = "\n".join([ap.toRadString() for ap in self.analysisPointsGroups])
    if hbObjects:
        _matStr, _geoStr = self.hbObjectsToRadString()
    return _radDefinition(_ptsStr, _matStr, _geoStr)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.updatePointGroups">
    <p>def <span class="ident">updatePointGroups</span>(</p><p>self, pointGroups, vectorGroups=[])</p>
    </div>
    

    
  
    <div class="desc"><p>Update point groups.</p>
<p>Args:
    pointGroups: A list of (x, y, z) test points or lists of (x, y, z)
        test points. Each list of test points will be converted to a
        TestPointGroup. If testPts is a single flattened list only one
        TestPointGroup will be created.
    vectorGroups: An optional list of (x, y, z) vectors. Each vector
        represents direction of corresponding point in testPts. If the
        vector is not provided (0, 0, 1) will be assigned.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.updatePointGroups', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.updatePointGroups" class="source">
    <pre><code>def updatePointGroups(self, pointGroups, vectorGroups=[]):
    """Update point groups.
    Args:
        pointGroups: A list of (x, y, z) test points or lists of (x, y, z)
            test points. Each list of test points will be converted to a
            TestPointGroup. If testPts is a single flattened list only one
            TestPointGroup will be created.
        vectorGroups: An optional list of (x, y, z) vectors. Each vector
            represents direction of corresponding point in testPts. If the
            vector is not provided (0, 0, 1) will be assigned.
    """
    self.createAnalysisPointGroups(pointGroups, vectorGroups)
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.writeHBObjectsToFile">
    <p>def <span class="ident">writeHBObjectsToFile</span>(</p><p>self, targetDir, projectName, mkdir=False, writeMaterial=True, writeGeometry=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Write HBobjects to *.rad and .mat files.</p>
<p>Args:
    targetDir: Path to project directory (e.g. c:/ladybug)
    projectName: Project name as string. Geometries will be saved as
        projectName.rad and materials will be saved as projectName.mat
    mkdir: Set to True to create the directory if doesn't exist (Default: False)</p>
<p>Returns:
    Path to materiald and geometry files as a tuple (<em>.mat, </em>.rad).</p>
<p>Exceptions:
    ValueError if targetDir doesn't exist and mkdir is False.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.writeHBObjectsToFile', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.writeHBObjectsToFile" class="source">
    <pre><code>def writeHBObjectsToFile(self, targetDir, projectName, mkdir=False,
                         writeMaterial=True, writeGeometry=True):
    """Write HBobjects to *.rad and .mat files.
    Args:
        targetDir: Path to project directory (e.g. c:/ladybug)
        projectName: Project name as string. Geometries will be saved as
            projectName.rad and materials will be saved as projectName.mat
        mkdir: Set to True to create the directory if doesn't exist (Default: False)
    Returns:
        Path to materiald and geometry files as a tuple (*.mat, *.rad).
    Exceptions:
        ValueError if targetDir doesn't exist and mkdir is False.
    """
    assert type(projectName) is str, "projectName should be a string."
    _matStr, _geoStr = self.hbObjectsToRadString()
    _mat = self.write(os.path.join(targetDir, projectName + ".mat"),
                      _matStr, mkdir) if writeMaterial else " "
    _geo = self.write(os.path.join(targetDir, projectName + ".rad"),
                      _geoStr, mkdir) if writeMaterial else " "
    if _mat and _geo:
        return _mat, _geo
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.writePointsToFile">
    <p>def <span class="ident">writePointsToFile</span>(</p><p>self, targetDir, projectName, mkdir=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Write point groups to file.</p>
<p>Args:
    targetDir: Path to project directory (e.g. c:/ladybug)
    projectName: Project name as string.Points will be saved as
        projectName.pts</p>
<p>Returns:
    Path to file in case of success.</p>
<p>Exceptions:
    ValueError if targetDir doesn't exist and mkdir is False.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.writePointsToFile', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.writePointsToFile" class="source">
    <pre><code>def writePointsToFile(self, targetDir, projectName, mkdir=False):
    """Write point groups to file.
    Args:
        targetDir: Path to project directory (e.g. c:/ladybug)
        projectName: Project name as string.Points will be saved as
            projectName.pts
    Returns:
        Path to file in case of success.
    Exceptions:
        ValueError if targetDir doesn't exist and mkdir is False.
    """
    assert type(projectName) is str, "projectName should be a string."
    projectName += ".pts"
    _pts = self.write(os.path.join(targetDir, projectName),
                      self.toRadString(points=True).points, mkdir)
    if _pts:
        return _pts
</code></pre>
  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.writeToFile">
    <p>def <span class="ident">writeToFile</span>(</p><p>self, targetFolder, projectName, radFiles=None, useRelativePath=False)</p>
    </div>
    

    
  
    <div class="desc"><p>Write analysis files to target folder.</p>
<p>Files for a grid based analysis are:
    test points <projectName.pts>: List of analysis points.
    sky file &lt;<em>.sky&gt;: Radiance sky for this analysis.
    material file &lt;</em>.mat&gt;: Radiance materials. Will be empty if HBObjects is None.
    geometry file &lt;<em>.rad&gt;: Radiance geometries. Will be empty if HBObjects is None.
    sky file &lt;</em>.sky&gt;: Radiance sky for this analysis.
    batch file &lt;<em>.bat&gt;: An executable batch file which has the list of commands.
        oconve &lt;</em>.sky&gt; <projectName.mat> <projectName.rad> <additional radFiles> &gt; <projectName.oct>
        rtrace <radianceParameters> <projectName.oct> &gt; <projectName.res>
    results file &lt;*.res&gt;: Results file once the analysis is over.</p>
<p>Args:
    targetFolder: Path to parent folder. Files will be created under
        targetFolder/gridbased. use self.subFolder to change subfolder name.
    projectName: Name of this project as a string.
    radFiles: A list of additional .rad files to be added to the scene
    useRelativePath: Set to True to use relative path in bat file <NotImplemented!>.</p>
<p>Returns:
    True in case of success.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.writeToFile', this);">Show source &equiv;</a></p>
  <div id="source-honeybee.radiance.recipe.gridbased.HBGridBasedAnalysisRecipe.writeToFile" class="source">
    <pre><code>def writeToFile(self, targetFolder, projectName, radFiles=None,
                useRelativePath=False):
    """Write analysis files to target folder.
    Files for a grid based analysis are:
        test points <projectName.pts>: List of analysis points.
        sky file <*.sky>: Radiance sky for this analysis.
        material file <*.mat>: Radiance materials. Will be empty if HBObjects is None.
        geometry file <*.rad>: Radiance geometries. Will be empty if HBObjects is None.
        sky file <*.sky>: Radiance sky for this analysis.
        batch file <*.bat>: An executable batch file which has the list of commands.
            oconve <*.sky> <projectName.mat> <projectName.rad> <additional radFiles> > <projectName.oct>
            rtrace <radianceParameters> <projectName.oct> > <projectName.res>
        results file <*.res>: Results file once the analysis is over.
    Args:
        targetFolder: Path to parent folder. Files will be created under
            targetFolder/gridbased. use self.subFolder to change subfolder name.
        projectName: Name of this project as a string.
        radFiles: A list of additional .rad files to be added to the scene
        useRelativePath: Set to True to use relative path in bat file <NotImplemented!>.
    Returns:
        True in case of success.
    """
    # 0.prepare target folder
    # create main folder targetFolder\projectName
    _basePath = os.path.join(targetFolder, projectName)
    _ispath = preparedir(_basePath)
    assert _ispath, "Failed to create %s. Try a different path!" % _basePath
    # create main folder targetFolder\projectName\gridbased
    _path = os.path.join(_basePath, self.subFolder)
    _ispath = preparedir(_path)
    assert _ispath, "Failed to create %s. Try a different path!" % _path
    # Check if anything has changed
    # if not self.isChanged:
    #     print "Inputs has not changed! Check files at %s" % _path
    # 1.write sky file
    skyFile = self.sky.writeToFile(_path)
    # 2.write points
    pointsFile = self.writePointsToFile(_path, projectName)
    # 3.write materials and geometry files
    matFile, geoFile = self.writeHBObjectsToFile(_path, projectName)
    # 4.write batch file
    batchFileLines = []
    # TODO: This line won't work for in linux.
    dirLine = "%s\ncd %s" % (os.path.splitdrive(_path)[0], _path)
    batchFileLines.append(dirLine)
    # # 4.1.prepare oconv
    oc = Oconv(projectName)
    oc.inputFiles = [skyFile, matFile, geoFile]
    # # 4.2.prepare rtrace
    rt = Rtrace(projectName,
                simulationType=self.simulationType,
                radianceParameters=self.radianceParameters)
    rt.octFile = os.path.join(_path, projectName + ".oct")
    rt.pointFile = pointsFile
    # # 4.3 write batch file
    batchFileLines.append(oc.toRadString())
    batchFileLines.append(rt.toRadString())
    batchFile = os.path.join(_path, projectName + ".bat")
    self.write(batchFile, "\n".join(batchFileLines))
    self.__batchFile = batchFile
    print "Files are written to: %s" % _path
    return _path
</code></pre>
  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.1</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a>
    </p>
  </footer>
</div>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>
